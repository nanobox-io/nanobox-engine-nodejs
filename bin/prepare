#!/bin/bash
# -*- mode: bash; tab-width: 2; -*-
# vim: ts=2 sw=2 ft=bash noet

# source the Nos framework
. /opt/nos/common.sh

# initialize Nos with the original arguments
nos_init $@

# source common lib
. ${engine_lib_dir}/common.sh

# install node.js or io.js
install_js_runtime

# run npm rebuild only if the runtime has changed
npm_rebuild

# install bower if a Bower.json file is detected
install_bower

# persist all environment variables 
persist_evars

# run npm install
npm_install

# run bower install if a Bower.json file is detected
bower_install

# set the node.js runtime in cache
set_js_runtime

exit 0
